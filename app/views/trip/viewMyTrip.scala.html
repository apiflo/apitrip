@(myTrip: Trip)

@import helper._

@main("Visualiser le parcours") {

	@_viewTripButtons(myTrip)
	@_heading(myTrip.title)
	
	<div id="login" class="row">
        <div class="col-lg-6">
        	@for(itinerary <- myTrip.itineries) {
          		@for(location <- itinerary.locations) {
        			<h3>@location.title</h3>
        			<p>@location.description</p>
        			
        		}      	
        	}
        </div>
        <div class="col-lg-6">
 			<div id="container">
				<div id="map-canvas"></div>
			</div>       
        </div>
     </div>

    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCiu-D3nCTBxJTBXoV_MR03nxvz7BDSr5w&sensor=false&libraries=places"></script>	
	<script type="text/javascript" charset="utf-8">
	
    	
       	function initialize() {
    		var paris = new google.maps.LatLng(48.853, 2.35);
            var mapOptions = {
              center: paris,
              zoom: 14,
              mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("map-canvas"),
                mapOptions);
    		
    		directionsDisplay.setMap(map);
           	
           	calculateDirection();
         }
       	
    	$(window).load(function(){
    		initialize();
    	});
	
		var map;
		  
		var directionsService = new google.maps.DirectionsService();
		var directionsDisplay = new google.maps.DirectionsRenderer();
		
		function calculateDirection() {
			
		var waypts = [];
			
        @for(itinerary <- myTrip.itineries) {
        @for(i <- 0 to itinerary.locations.size-1) {
        
        @if(i == 0){
			start = new google.maps.LatLng(@itinerary.locations(i).latitude, @itinerary.locations(i).longitude);
        }
        
        
        @if(i == (itinerary.locations.size - 1)){
			end = new google.maps.LatLng(@itinerary.locations(i).latitude, @itinerary.locations(i).longitude);
        }
        
        @if((i != (itinerary.locations.size-1)) && (i != 0)){
				waypts.push({
					location:new google.maps.LatLng(@itinerary.locations(i).latitude, @itinerary.locations(i).longitude),
					stopover:true
				});
        }
		}
		}
			var request = {
				origin:start,
				destination:end,
			    waypoints: waypts,
			    optimizeWaypoints: true,
				travelMode: google.maps.TravelMode.WALKING 
			};
			directionsService.route(request, function(result, status) {
				if (status == google.maps.DirectionsStatus.OK) {
					directionsDisplay.setDirections(result);
				}
   			});
		}
	  
    </script>
	

}
    
    